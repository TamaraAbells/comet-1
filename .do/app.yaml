name: comet
region: nyc
services:
  - name: server
    image:
      registry_type: DOCKER_HUB
      registry: joincomet
      repository: server
      tag: latest
    instance_count: 1
    instance_size_slug: basic-xxs
    http_port: 4000
    routes:
      - path: /api
    envs:
      - key: DATABASE_URL
        value: ${db.DATABASE_URL}
      - key: CA_CERT
        value: ${db.CA_CERT}
      - key: CORS_ORIGIN
        value: ${web.PUBLIC_URL}
      - key: ACCESS_TOKEN_SECRET
        value: change this!
      - key: BUCKET
        value: comet
      - key: AWS_ACCESS_KEY_ID
        value: change this!
      - key: AWS_SECRET_ACCESS_KEY
        value: change this!
      - key: AWS_ENDPOINT
        value: nyc3.digitaloceanspaces.com
      - key: MEDIA_DOMAIN
        value: media.joincomet.app
  - name: web
    image:
      registry_type: DOCKER_HUB
      registry: joincomet
      repository: web
      tag: latest
    instance_count: 1
    instance_size_slug: basic-xxs
    http_port: 3000
    routes:
      - path: /
databases:
  - name: db
    engine: PG
    production: false
